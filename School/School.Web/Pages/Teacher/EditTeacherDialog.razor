@using School.Web.PageModels.Teachers

@if (ViewModel?.Model != null)
{
    <MatDialog IsOpen="@ViewModel.IsOpenDialog" CanBeClosed="false">
        <EditForm Model="ViewModel.Model" OnValidSubmit="@(() => { Save.InvokeAsync(ViewModel.Model); })">
        <MatDialogTitle class="diHeader">
        </MatDialogTitle>
        <MatDialogContent>
                <DataAnnotationsValidator />

            @if (ViewModel.Model != null)
            {
                <h4>@(ViewModel.Model.Id == 0 ? "Добавление нового преподавателя" : "Изменение данных преподавателя")</h4>

                    <div class="card p-3 mt-3">
                        @if (ViewModel.IsConcurrency == true)
                        {
                            <label class="text-danger">У вас устарели данные</label>
                        }
                        <div class="form-group">
                        <label>Фамилия:</label>
                            <InputText @bind-Value="@ViewModel.Model.LastName" Class="form-control form-control-sm col-9" id="LastName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.LastName)" />
                        @* <input class="form-control" @bind="ViewModel.Model.LastName" /> *@
                    </div>

                    <div class="form-group mt-2">
                        <label>Имя:</label>
                            <InputText @bind-Value="@ViewModel.Model.FirstName" Class="form-control form-control-sm col-9" id="FirstName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.FirstName)" />
                        @* <input class="form-control" @bind="ViewModel.Model.FirstName" /> *@
                    </div>

                    <div class="form-group mt-2">
                        <label>Отчество:</label>
                            <InputText @bind-Value="@ViewModel.Model.MiddleName" Class="form-control form-control-sm col-9" id="MiddleName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.MiddleName)" />
                        @* <input class="form-control" @bind="ViewModel.Model.MiddleName" /> *@
                    </div>

                    <div class="form-group mt-2">
                        <label>Возраст:</label>
                            <InputNumber @bind-Value="@ViewModel.Model.Age" Class="form-control form-control-sm col-9" id="Age"></InputNumber>
                            <ValidationMessage For="@(() => ViewModel.Model.Age)" />
                        @* <input class="form-control" @bind="ViewModel.Model.Age" /> *@
                    </div>

                    <div class="form-group mt-2">
                        <label>Предмет:</label>
                            <InputText @bind-Value="@ViewModel.Model.SubjectName" Class="form-control form-control-sm col-9" id="SubjectName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.SubjectName)" />
                        @* <input class="form-control" @bind="ViewModel.Model.SubjectName" /> *@
                    </div>

                    <div class="mt-3">
                        @if(ViewModel.IsConcurrency == true)
                            {
                                <span class="btn btn-danger" @onclick="@(() => Reload.InvokeAsync(ViewModel.Model))">Обновить</span>
                            }
                        else
                        {
                                <input class="btn btn-success" type="submit" value="Сохранить" />
                        }
                            <span class="btn btn-secondary" @onclick="@(() => Save.InvokeAsync(null))">Отмена</span>
                    </div>
                </div>
            }
        </MatDialogContent>
        </EditForm>
    </MatDialog>
}

@code {
    [Parameter] public EditTeacherModel ViewModel { get; set; }
    [Parameter] public EventCallback<TeacherItemViewModel> Save { get; set;  }
    [Parameter] public EventCallback<TeacherItemViewModel> Reload { get; set; }
}
