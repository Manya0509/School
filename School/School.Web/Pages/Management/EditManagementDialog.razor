@using School.Web.PageModels.Managements

@if(ViewModel?.Model != null)
{ 
<MatDialog  IsOpen="@ViewModel.IsOpenDialog" CanBeClosed="false">
    <EditForm Model="ViewModel.Model" OnValidSubmit="@(() => { Save.InvokeAsync(ViewModel.Model); })">
    <MatDialogTitle class="diHeader">
    </MatDialogTitle>
    <MatDialogContent>
            <DataAnnotationsValidator />

        @if (ViewModel.Model != null)
        {
            <h4> @(ViewModel.Model.Id == 0 ? "Добавление нового руководителя" : "Изменение данных руководителя")</h4>

            <div class="card p-3 mt-3">
                        @if (ViewModel.IsConcurrency == true)
                        {
                            <label class="text-danger">У вас устарели данные</label>
                        }
                <div class="form-group">
                    <label>Должность:</label>
                        <InputText @bind-Value="@ViewModel.Model.Position" Class="form-control form-control-sm col-9" id="Position"></InputText>
                        <ValidationMessage For="@(() => ViewModel.Model.Position)" />
@*                     <input class="form-control" @bind="ViewModel.Model.Position " /> *@
                </div>

                <div class="form-group mt-2">
                    <label>Фамилия:</label>
                            <InputText @bind-Value="@ViewModel.Model.LastName" Class="form-control form-control-sm col-9" id="LastName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.LastName)" />
                    @* <input class="form-control" @bind="ViewModel.Model.LastName" /> *@
                </div>

                <div class="form-group mt-2">
                    <label>Имя:</label>
                            <InputText @bind-Value="@ViewModel.Model.FirstName" Class="form-control form-control-sm col-9" id="FirstName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.FirstName)" />
                    @* <input class="form-control" @bind="ViewModel.Model.FirstName" /> *@
                </div>

                <div class="form-group mt-2">
                    <label>Отчество:</label>
                            <InputText @bind-Value="@ViewModel.Model.MiddleName" Class="form-control form-control-sm col-9" id="MiddleName"></InputText>
                            <ValidationMessage For="@(() => ViewModel.Model.MiddleName)" />
                    @* <input class="form-control" @bind="ViewModel.Model.MiddleName" /> *@
                </div>

                <div class="form-group mt-2">
                    <label>Возраст:</label>
                            <InputNumber @bind-Value="@ViewModel.Model.Age" Class="form-control form-control-sm col-9" id="Age"></InputNumber>
                            <ValidationMessage For="@(() => ViewModel.Model.Age)" />
                    @* <input class="form-control" @bind="ViewModel.Model.Age" /> *@
                </div>

                <div class="mt-3">
                       @if (ViewModel.IsConcurrency == true)
                       {
                          <span class="btn btn-danger" @onclick="@(() => Reload.InvokeAsync(ViewModel.Model))">Обновить</span>
                       }
                       else
                       {
                          <input class="btn btn-success" type="submit" value="Сохранить" />
                       }
                          <span class="btn btn-secondary" @onclick="@(() => Save.InvokeAsync(null))">Отмена</span>
                </div>
            </div>
                }
    </MatDialogContent>
    </EditForm>
</MatDialog>
}

@code {
    [Parameter] public EditManagementModel ViewModel { get; set; }
    [Parameter] public EventCallback<ManagementItemViewModel> Save { get; set; }
    [Parameter] public EventCallback<ManagementItemViewModel> Reload { get; set; }
}

